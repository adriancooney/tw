#!/usr/bin/env babel-node --
import Command from "../src/library/Command";
import * as cli from "../src/cli";
import { CLIError } from "../src/cli/error";

export default class ProjectsCommand extends Command {
    execute(options) {
        return this.getAPI().then(api => {
            return [api, api.getProjects()];
        }).spread((api, projects) => {
            cli.output.log(this.color.yellow(`${api.installation.name} (${api.installation.domain})`));
            cli.output.log(cli.format.list(projects, project => {
                const id = `#${cli.format.fixLength(project.id, 6)}`
                let title = project.title;

                if(project.starred) title = this.color.yellow(title + " " + cli.output.STAR);
                else title = this.color.magenta(title);

                return `${id} ${title}`;
            }));
        });
    }
}

if(require.main === module)
    cli.run(ProjectsCommand);