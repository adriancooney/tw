#!/usr/bin/env babel-node --
import Command from "../src/library/Command";
import * as cli from "../src/cli";
import { CLIError } from "../src/cli/error";

export default class TasklistsCommand extends Command {
    setup(command) {
        this.addScopeOptions(command, "List tasks for", ["project"]);
    }

    execute(options) {
        return this.getAPI().then(api => {
            return [api, this.requireScopeFromOptions(api, options, ["project"])];
        }).spread((api, project) => {
            return [project, api.getTasklists(project)];
        }).spread((project, tasklists) => {
            cli.output.log(cli.output.scope(project));
            cli.output.log(cli.format.list(tasklists, tasklist => {
                const id = cli.format.fixLength(tasklist.id, 6);
                return `#${id} ${this.color.magenta(tasklist.title)}`;
            }));
        });
    }
}

if(require.main === module)
    cli.run(TasklistsCommand);